<!DOCTYPE HTML>
<html>
<head>
    <title>Ajmide Static Tool</title>
    <!-- <script type="text/javascript" src="//code.jquery.com/jquery-1.4.2.min.js"></script> -->
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>

    <link rel="stylesheet" href="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script type="text/javascript" charset="utf-8">
        var total=0;
        $(document).ready(function() {

            namespace = '/test';


            var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port + namespace);
            console.log(socket);


            socket.on('connect', function() {
                socket.emit('my_event', {data: 'I\'m connected!'});
            });


            socket.on('my_response', function(msg) {
  

               total++;
                $('#clickbaoad').prepend(('<tr> ' +'<td> '+ total+'</td>' +'<td> '+ msg.data +'</td>'+'<td> '+ msg.body+'</td>'+'</tr>'));
            });




            var ping_pong_times = [];
            var start_time;
            window.setInterval(function() {
                start_time = (new Date).getTime();
                socket.emit('my_ping');
            }, 1000);

            // Handler for the "pong" message. When the pong is received, the
            // time from the ping is stored, and the average of the last 30
            // samples is average and displayed.
            socket.on('my_pong', function() {
                var latency = (new Date).getTime() - start_time;
                ping_pong_times.push(latency);
                ping_pong_times = ping_pong_times.slice(-30); // keep last 30 samples
                var sum = 0;
                for (var i = 0; i < ping_pong_times.length; i++)
                    sum += ping_pong_times[i];
                $('#ping-pong').text(Math.round(10 * sum / ping_pong_times.length) / 10);
            });

            // Handlers for the different forms in the page.
            // These accept data from the user and send it to the server in a
            // variety of ways
            $('form#emit').submit(function(event) {
                socket.emit('my_event', {data: $('#emit_data').val()});
                return false;
            });
            $('form#broadcast').submit(function(event) {
                socket.emit('my_broadcast_event', {data: $('#broadcast_data').val()});
                return false;
            });
            $('form#join').submit(function(event) {
                socket.emit('join', {room: $('#join_room').val()});
                return false;
            });
            $('form#leave').submit(function(event) {
                socket.emit('leave', {room: $('#leave_room').val()});
                return false;
            });
            $('form#send_room').submit(function(event) {
                socket.emit('my_room_event', {room: $('#room_name').val(), data: $('#room_data').val()});
                return false;
            });
            $('form#close').submit(function(event) {
                socket.emit('close_room', {room: $('#close_room').val()});
                return false;
            });
            $('form#disconnect').submit(function(event) {
                socket.emit('disconnect_request');
                return false;
            });
        });









    </script>
</head>
<body background="http://pic.qiantucdn.com/58pic/12/85/85/37D58PICSaM.jpg!/fw/780/watermark/url/L3dhdGVybWFyay12MS4zLnBuZw==/align/center/crop/1024x768a0a0">

<div class="container-fluid">


    <h1>Ajmide Static Tool</h1>

    <p>Async mode is: <b>{{ async_mode }}</b></p>
    <p>Average ping/pong latency: <b><span id="ping-pong"></span>ms</b></p>


    <div class="row">
        <div class=" col-md-12 col-md-offset-0">
            <h2>Receive:</h2>

        </div>

    </div>

    <div class="row">
        <div class="col-xs-12   col-xd-12 col-md-offset-0">

            <div class="panel panel-default">
                <!-- Default panel contents -->
                <div class="panel-heading">點擊埋點</div>
                <!--<div class="panel-body">-->
                <!--&lt;!&ndash;<p></p>&ndash;&gt;-->
                <!--<hr>-->
                <!--</div>-->

                <table style=" background-color:#BBBBBB;" id="blackboard" class="table table-responsive table-striped "  >
                    <thead>
                    <tr style="background-color:#888888; color:#ffffff">
                        <th >ID</th>
                        <th>URL</th>
                        <th>body</th>
                    </tr>
                    </thead>
                    <tbody id="clickbaoad">

                    </tbody>
                </table>

            </div>

        </div>

    </div>


</div>

</body>
</html>
